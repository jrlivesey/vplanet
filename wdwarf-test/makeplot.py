import matplotlib.pyplot as plt
import numpy as np
import pathlib
import pandas as pd
# from seaborn import color_palette
import vplanet

path = pathlib.Path()


## VPLANET OUTPUT
vpl_time  = []
vpl_lum   = []
vpl_temp  = []

out = vplanet.get_output(path)
bodies = [getattr(out, attr) for attr in dir(out) \
          if type(getattr(out, attr)) == vplanet.Body]
for body in bodies:
    vpl_time.append(body.Time.value + 6.2e6)
    vpl_lum.append(body.WDLuminosity.value)
    vpl_temp.append(body.WDTemperature.value)


## BASTI CURVES
basti_time = []
basti_lum  = []
basti_temp = []

basti_dir = path / '../src/tracks/Data/basti-grids/c07DAZ03ACS'
for filename in basti_dir.iterdir():
    df = pd.read_table(
        filename,
        comment='#',
        delim_whitespace=True,
        header=None,
        names = [
            'log(t)',
            'Mwd',
            'log(Teff)',
            'log(L/Lo)',
            'F435W',
            'F475',
            'F502N',
            'F550M',
            'F555W',
            'F606W',
            'F625W',
            'F658N',
            'F660N',
            'F775W',
            'F814W',
            'F850LP',
            'F892N',
        ],
        encoding='ascii'
    )
    print(df['Mwd'].iloc[0])
    logt = df['log(t)'].to_numpy()
    logL = df['log(L/Lo)'].to_numpy()
    logT = df['log(Teff)'].to_numpy()
    basti_time.append(10.0 ** logt)
    basti_lum.append(10.0 ** logL)
    basti_temp.append(10.0 ** logT)


## MAKE PLOT
plt.rcParams['mathtext.fontset'] = 'cm'
plt.rcParams['font.family'] = 'cmu serif'
# palette = color_palette('colorblind', len(bodies))

# fig, ax = plt.subplots(1, 2, figsize=(12, 6))
# for i, t in enumerate(basti_time):
#     # Time in Myr, luminosity in solar luminosities, temperature in K
#     ax[0].plot(t/1.e6, basti_lum[i],  color='r')
#     ax[1].plot(t/1.e6, basti_temp[i], color='r')
# for i, t in enumerate(vpl_time):
#     # Time in Myr, luminosity in solar luminosities, temperature in K
#     ax[0].plot(t/1.e6, vpl_lum[i],  color='k')
#     ax[1].plot(t/1.e6, vpl_temp[i], color='k')
# ax[0].set_ylabel(r'Luminosity ($L_\odot$)')
# ax[1].set_ylabel('Temperature (K)')
# ax[0].set_ylim(1.e-6, 1.e1)
# ax[1].set_ylim(3.e4, 5.e4)
# for a in ax:
#     a.set_xlim(vpl_time[0][0]/1.e6, vpl_time[0][-1]/1.e6)
#     a.set_yscale('log')
#     a.set_xlabel('Time (Myr)')
#     # a.legend(loc=0)
# fig.tight_layout()
# fig.savefig(path / 'wdtest.pdf')










## IS THE PROBLEM WITH PRE-PROCESSING THE GRIDS?
pp_track_logL = np.array([-0.082502, -0.097291, -0.111834, -0.126028, -0.140031, -0.153794, -0.167318, -0.180665, -0.193718, -0.206611, -0.219222, -0.231662, -0.243801, -0.255753, -0.267515, -0.279142, -0.290546, -0.301768, -0.312837, -0.323733, -0.334390, -0.344813, -0.355115, -0.365292, -0.375344, -0.385268, -0.394993, -0.404494, -0.413833, -0.422995, -0.432087, -0.441054, -0.449865, -0.458470, -0.466845, -0.475128, -0.483336, -0.491415, -0.499204, -0.506837, -0.514366, -0.521755, -0.529050, -0.536139, -0.543087, -0.549933, -0.556586, -0.563162, -0.569531, -0.575799, -0.581953, -0.588001, -0.593990, -0.599748, -0.605434, -0.610979, -0.616492, -0.621819, -0.627093, -0.632222, -0.637280, -0.642245, -0.647109, -0.651927, -0.656561, -0.661196, -0.665710, -0.670199, -0.674609, -0.678876, -0.683144, -0.687276, -0.691370, -0.695446, -0.699335, -0.703224, -0.707078, -0.710844, -0.714609, -0.718309, -0.721895, -0.725482, -0.729033, -0.732514, -0.735995, -0.739449, -0.742769, -0.746089, -0.749409, -0.752654, -0.755889, -0.759124, -0.762310, -0.765443, -0.768576, -0.771709, -0.774731, -0.777751, -0.780770, -0.783771, -0.786740, -0.789709, -0.792678, -0.795619, -0.798546, -0.801472, -0.804399, -0.807253, -0.810096, -0.812939, -0.815782, -0.818603, -0.821424, -0.824245, -0.827064, -0.829849, -0.832634, -0.835420, -0.838203, -0.840965, -0.843727, -0.846489, -0.849251, -0.852027, -0.854803, -0.857580, -0.860356, -0.863152, -0.865948, -0.868744, -0.871541, -0.874354, -0.877167, -0.879981, -0.882794, -0.885628, -0.888463, -0.891297, -0.894132, -0.897047, -0.899964, -0.902881, -0.905799, -0.908744, -0.911690, -0.914635, -0.917592, -0.920614, -0.923635, -0.926656, -0.929700, -0.932785, -0.935871, -0.938956, -0.942102, -0.945284, -0.948466, -0.951649, -0.954912, -0.958177, -0.961442, -0.964744, -0.968095, -0.971447, -0.974798, -0.978270, -0.981745, -0.985221, -0.988755, -0.992329, -0.995902, -0.999510, -1.003187, -1.006865, -1.010559, -1.014344, -1.018129, -1.021923, -1.025853, -1.029783, -1.033719, -1.037770, -1.041822, -1.045885, -1.050018, -1.054151, -1.058342, -1.062659, -1.066977, -1.071356, -1.075786, -1.080216, -1.084763, -1.089325, -1.093928, -1.098623, -1.103318, -1.108145, -1.113007, -1.117904, -1.122867, -1.127830, -1.132959, -1.138093, -1.143286, -1.148511, -1.153805, -1.159209, -1.164629, -1.170119, -1.175616, -1.181284, -1.186952, -1.192697, -1.198448, -1.204359, -1.210289, -1.216285, -1.222290, -1.228450, -1.234625, -1.240863, -1.247113, -1.253464, -1.259853, -1.266359, -1.272891, -1.279458, -1.286103, -1.292797, -1.299614, -1.306458, -1.313335, -1.320250, -1.327224, -1.334262, -1.341332, -1.348490, -1.355706, -1.363017, -1.370347, -1.377698, -1.385124, -1.392597, -1.400108, -1.407702, -1.415362, -1.423106, -1.430860, -1.438646, -1.446481, -1.454382, -1.462321, -1.470306, -1.478358, -1.486478, -1.494679, -1.502885, -1.511136, -1.519431, -1.527783, -1.536162, -1.544573, -1.553029, -1.561545, -1.570137, -1.578791, -1.587432, -1.596121, -1.604848, -1.613610, -1.622425, -1.631281, -1.640172, -1.649099, -1.658071, -1.667081, -1.676123, -1.685199, -1.694313, -1.703534, -1.712754, -1.721976, -1.731233, -1.740540, -1.749882, -1.759250, -1.768638, -1.778035, -1.787478, -1.796952, -1.806455, -1.815987, -1.825546, -1.835138, -1.844755, -1.854397, -1.864060, -1.873746, -1.883454, -1.893182, -1.902928, -1.912690, -1.922467, -1.932259, -1.942068, -1.951890, -1.961726, -1.971576, -1.981415, -1.991210, -2.001091, -2.010981, -2.020871, -2.030771, -2.040687, -2.050621, -2.060560, -2.070503, -2.080386, -2.090294, -2.100239, -2.110184, -2.120127, -2.130069, -2.139939, -2.149842, -2.159775, -2.169704, -2.179625, -2.189462, -2.199367, -2.209280, -2.219188, -2.229068, -2.238894, -2.248792, -2.258679, -2.268558, -2.278437, -2.288292, -2.298100, -2.307978, -2.317854, -2.327726, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 
])
pp_track_logT = np.array([4.765712, 4.762172, 4.758692, 4.755371, 4.752052, 4.748802, 4.745547, 4.742439, 4.739300, 4.736225, 4.733273, 4.730311, 4.727434, 4.724587, 4.721819, 4.719028, 4.716312, 4.713666, 4.711023, 4.708459, 4.705880, 4.703428, 4.700941, 4.698567, 4.696158, 4.693818, 4.691536, 4.689268, 4.686998, 4.684847, 4.682665, 4.680531, 4.678458, 4.676420, 4.674437, 4.672446, 4.670457, 4.668560, 4.666697, 4.664865, 4.663082, 4.661332, 4.659601, 4.657907, 4.656247, 4.654612, 4.653022, 4.651447, 4.649912, 4.648401, 4.646917, 4.645468, 4.644037, 4.642682, 4.641350, 4.640020, 4.638691, 4.637435, 4.636200, 4.634968, 4.633737, 4.632551, 4.631411, 4.630281, 4.629186, 4.628090, 4.627031, 4.625980, 4.624930, 4.623882, 4.622835, 4.621849, 4.620882, 4.619918, 4.618990, 4.618062, 4.617145, 4.616255, 4.615365, 4.614488, 4.613632, 4.612777, 4.611932, 4.611109, 4.610287, 4.609474, 4.608713, 4.607951, 4.607190, 4.606399, 4.605605, 4.604811, 4.604043, 4.603303, 4.602562, 4.601822, 4.601101, 4.600381, 4.599660, 4.598947, 4.598245, 4.597543, 4.596842, 4.596150, 4.595465, 4.594779, 4.594094, 4.593420, 4.592748, 4.592076, 4.591404, 4.590743, 4.590083, 4.589422, 4.588760, 4.588083, 4.587405, 4.586728, 4.586052, 4.585405, 4.584759, 4.584112, 4.583464, 4.582794, 4.582125, 4.581456, 4.580787, 4.580118, 4.579450, 4.578782, 4.578114, 4.577442, 4.576770, 4.576097, 4.575425, 4.574748, 4.574071, 4.573394, 4.572716, 4.572032, 4.571347, 4.570662, 4.569977, 4.569279, 4.568581, 4.567884, 4.567180, 4.566445, 4.565709, 4.564973, 4.564242, 4.563517, 4.562793, 4.562069, 4.561317, 4.560549, 4.559781, 4.559012, 4.558225, 4.557437, 4.556648, 4.555851, 4.555042, 4.554234, 4.553425, 4.552594, 4.551762, 4.550930, 4.550084, 4.549229, 4.548374, 4.547511, 4.546630, 4.545750, 4.544866, 4.543960, 4.543054, 4.542147, 4.541215, 4.540282, 4.539346, 4.538350, 4.537355, 4.536360, 4.535371, 4.534382, 4.533384, 4.532368, 4.531353, 4.530296, 4.529208, 4.528119, 4.527036, 4.525953, 4.524849, 4.523695, 4.522541, 4.521363, 4.520178, 4.518996, 4.517818, 4.516640, 4.515392, 4.514140, 4.512868, 4.511584, 4.510305, 4.509033, 4.507747, 4.506398, 4.505049, 4.503716, 4.502382, 4.500974, 4.499560, 4.498119, 4.496673, 4.495201, 4.493725, 4.492271, 4.490818, 4.489285, 4.487749, 4.486188, 4.484635, 4.483104, 4.481539, 4.479925, 4.478292, 4.476646, 4.474983, 4.473320, 4.471688, 4.470024, 4.468310, 4.466580, 4.464843, 4.463084, 4.461340, 4.459620, 4.457837, 4.456030, 4.454205, 4.452369, 4.450523, 4.448656, 4.446809, 4.444987, 4.443089, 4.441176, 4.439250, 4.437309, 4.435357, 4.433395, 4.431478, 4.429528, 4.427530, 4.425513, 4.423485, 4.421447, 4.419394, 4.417385, 4.415368, 4.413289, 4.411197, 4.409094, 4.406983, 4.404859, 4.402781, 4.400679, 4.398526, 4.396359, 4.394183, 4.391997, 4.389804, 4.387599, 4.385444, 4.383262, 4.381032, 4.378792, 4.376542, 4.374284, 4.372018, 4.369745, 4.367536, 4.365260, 4.362957, 4.360650, 4.358340, 4.356020, 4.353692, 4.351356, 4.349034, 4.346764, 4.344407, 4.342043, 4.339674, 4.337299, 4.334918, 4.332532, 4.330142, 4.327804, 4.325447, 4.323045, 4.320638, 4.318227, 4.315813, 4.313396, 4.310975, 4.308574, 4.306225, 4.303797, 4.301367, 4.298936, 4.296503, 4.294066, 4.291625, 4.289182, 4.286738, 4.284294, 4.281896, 4.279506, 4.277062, 4.274618, 4.272175, 4.269732, 4.267290, 4.264849, 4.262429, 4.260070, 4.257632, 4.255194, 4.252758, 4.250323, 4.247889, 4.245456, 4.243023, 4.240593, 4.238166, 4.235738, 4.233336, 4.230980, 4.228553, 4.226126, 4.223699, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 
])
pp_track_lum  = 10.0 ** pp_track_logL
pp_track_temp = 10.0 ** pp_track_logT
pp_track_age  = np.array([
    0.00125892541179416619,
    0.00128060392816645727,
    0.00130265574550455696,
    0.00132508729199795118,
    0.00134790510652864175,
    0.00137111584057723955,
    0.00139472626016190764,
    0.00141874324781067571,
    0.00144317380456773477,
    0.00146802505203425145,
    0.00149330423444435389,
    0.00151901872077685033,
    0.00154517600690331222,
    0.00157178371777316121,
    0.00159884960963635383,
    0.00162638157230436914,
    0.00165438763145011399,
    0.00168287595094744982,
    0.00171185483525097370,
    0.00174133273181681218,
    0.00177131823356508353,
    0.00180182008138476350,
    0.00183284716668170346,
    0.00186440853397048514,
    0.00189651338351094940,
    0.00192917107399010000,
    0.00196239112525019603,
    0.00199618322106383684,
    0.00203055721195679380,
    0.00206552311807949637,
    0.00210109113212793124,
    0.00213727162231487373,
    0.00217407513539223272,
    0.00221151239972548893,
    0.00224959432842104876,
    0.00228833202250745306,
    0.00232773677417138797,
    0.00236782007004937220,
    0.00240859359457617486,
    0.00245006923339086396,
    0.00249225907680153532,
    0.00253517542330965314,
    0.00257883078319513142,
    0.00262323788216312385,
    0.00266840966505360903,
    0.00271435929961488407,
    0.00276110018034198034,
    0.00280864593238123322,
    0.00285701041550205691,
    0.00290620772813711794,
    0.00295625221149210153,
    0.00300715845372619790,
    0.00305894129420462672,
    0.00311161582782435667,
    0.00316519740941435422,
    0.00321970165821153535,
    0.00327514446241385744,
    0.00333154198381177893,
    0.00338891066249950986,
    0.00344726722166732160,
    0.00350662867247644684,
    0.00356701231901789505,
    0.00362843576335665063,
    0.00369091691066277460,
    0.00375447397443078425,
    0.00381912548178898635,
    0.00388489027890020176,
    0.00395178753645548247,
    0.00401983675526247728,
    0.00408905777192993848,
    0.00415947076465021052,
    0.00423109625908123232,
    0.00430395513432984666,
    0.00437806862903816589,
    0.00445345834757467345,
    0.00453014626633200732,
    0.00460815474013315154,
    0.00468750650874798745,
    0.00476822470352196697,
    0.00485033285411902871,
    0.00493385489538056537,
    0.00501881517430255789,
    0.00510523845713276286,
    0.00519314993659021271,
    0.00528257523920896629,
    0.00537354043280834776,
    0.00546607203409184891,
    0.00556019701637678557,
    0.00565594281745717201,
    0.00575333734760192974,
    0.00585240899769082310,
    0.00595318664749056124,
    0.00605569967407329143,
    0.00615997796038016826,
    0.00626605190393234382,
    0.00637395242569194134,
    0.00648371097907569048,
    0.00659535955912363830,
    0.00670893071182586658,
    0.00682445754360981593,
    0.00694197373099085090,
    0.00706151353038915464,
    0.00718311178811558218,
    0.00730680395052949253,
    0.00743262607437154658,
    0.00756061483727430567,
    0.00769080754845395415,
    0.00782324215958606940,
    0.00795795727586866460,
    0.00809499216727581176,
    0.00823438678000490247,
    0.00837618174812117082,
    0.00852041840540267333,
    0.00866713879738922367,
    0.00881638569363889929,
    0.00896820260019541918,
    0.00912263377227040713,
    0.00927972422714390920,
    0.00943951975728717953,
    0.00960206694371125782,
    0.00976741316954557806,
    0.00993560663385029130,
    0.01010669636566657523,
    0.01028073223830864788,
    0.01045776498390212084,
    0.01063784620817258796,
    0.01082102840548886460,
    0.01100736497416539977,
    0.01119691023202793942,
    0.01138971943224748214,
    0.01158584877944676510,
    0.01178535544608410625,
    0.01198829758911948429,
    0.01219473436696738404,
    0.01240472595674177968,
    0.01261833357179799157,
    0.01283561947957657240,
    0.01305664701975462090,
    0.01328148062270937194,
    0.01351018582829999030,
    0.01374282930497278989,
    0.01397947886919504931,
    0.01422020350522415662,
    0.01446507338521647000,
    0.01471415988968290123,
    0.01496753562829667913,
    0.01522527446105918086,
    0.01548745151983052515,
    0.01575414323023076324,
    0.01602542733391821433,
    0.01630138291125158082,
    0.01658209040434199463,
    0.01686763164050230843,
    0.01715808985610006721,
    0.01745354972082116887,
    0.01775409736235156188,
    0.01805982039148358587,
    0.01837080792765496962,
    0.01868715062492749129,
    0.01900894069841291278,
    0.01933627195115422345,
    0.01966923980146933690,
    0.02000794131076601146,
    0.02035247521183575561,
    0.02070294193763457663,
    0.02105944365055971088,
    0.02142208427223035033,
    0.02179096951378111865,
    0.02216620690667746307,
    0.02254790583406122984,
    0.02293617756263643601,
    0.02333113527510390431,
    0.02373289410315440606,
    0.02414157116103017586,
    0.02455728557966389489,
    0.02498015854140597791,
    0.02541031331534968074,
    0.02584787529326442249,
    0.02629297202614822027,
    0.02674573326140894727,
    0.02720629098068636995,
    0.02767477943832553564,
    0.02815133520051179075,
    0.02863609718508115798,
    0.02912920670201479476,
    0.02963080749463161204,
    0.03014104578149018332,
    0.03066007029901167413,
    0.03118803234483730549,
    0.03172508582193213356,
    0.03227138728344831897,
    0.03282709597836118431,
    0.03339237389789057042,
    0.03396738582272209456,
    0.03455229937104135896,
    0.03514728504739515758,
    0.03575251629239453721,
    0.03636816953327295238,
    0.03699442423531579260,
    0.03763146295417509751,
    0.03827947138908516928,
    0.03893863843699492400,
    0.03960915624763160919,
    0.04029122027951344276,
    0.04098502935692678595,
    0.04169078572788335185,
    0.04240869512307742645,
    0.04313896681585620285,
    0.04388181368322411485,
    0.04463745226789757325,
    0.04540610284142750086,
    0.04618798946840962233,
    0.04698334007180012678,
    0.04779238649935595162,
    0.04861536459121969939,
    0.04945251424866738132,
    0.05030407950404088002,
    0.05117030859188432396,
    0.05205145402130519766,
    0.05294777264958220458,
    0.05385952575703953360,
    0.05478697912321140590,
    0.05573040310431784383,
    0.05669007271207433807,
    0.05766626769385933826,
    0.05865927261426096689,
    0.05966937693802904646,
    0.06069687511445552575,
    0.06174206666320692510,
    0.06280525626163585562,
    0.06388675383359559978,
    0.06498687463978393419,
    0.06610593936964334616,
    0.06724427423484249933,
    0.06840221106436866760,
    0.06958008740125706804,
    0.07077824660098576415,
    0.07199703793156571330,
    0.07323681667535286710,
    0.07449794423261495158,
    0.07578078822688077976,
    0.07708572261210387688,
    0.07841312778167210118,
    0.07976339067929280602,
    0.08113690491178890407,
    0.08253407086383741931,
    0.08395529581468132163,
    0.08540099405685541711,
    0.08687158701695221752,
    0.08836750337847022740,
    0.08988917920677726159,
    0.09143705807622416748,
    0.09301159119944914233,
    0.09461323755890779785,
    0.09624246404066805205,
    0.09789974557051010773,
    0.09958556525236782198,
    0.10130041450915606982,
    0.10304479322602315416,
    0.10481920989606703654,
    0.10662418176856568175,
    0.10846023499975598892,
    0.11032790480620907614,
    0.11222773562085093524,
    0.11416028125166331753,
    0.11612610504312387283,
    0.11812578004042201263,
    0.12015988915650228919,
    0.12222902534198915037,
    0.12433379175803033201,
    0.12647480195212421061,
    0.12865268003696983534,
    0.13086806087239635787,
    0.13312159025043104887,
    0.13541392508354574420,
    0.13774573359615321921,
    0.14011769551939545764,
    0.14253050228928629273,
    0.14498485724827153698,
    0.14748147585025145334,
    0.15002108586914245092,
    0.15260442761102416265,
    0.15523225412993965633,
    0.15790533144741791816,
    0.16062443877576706996,
    0.16339036874522216980,
    0.16620392763499819422,
    0.16906593560832131051,
    0.17197722695151440586,
    0.17493865031718930370,
    0.17795106897163723292,
    0.18101536104647186765,
    0.18413241979460620579,
    0.18730315385064422173,
    0.19052848749574533005,
    0.19380936092706119167,
    0.19714673053180389872,
    0.20054156916603801952,
    0.20399486643826927890,
    0.20750762899792113414,
    0.21108088082877835001,
    0.21471566354747997907,
    0.21841303670715608853,
    0.22217407810628825304,
    0.22599988410289795215,
    0.22989156993413206731,
    0.23385027004136529905,
    0.23787713840089122486,
    0.24197334886030799628,
    0.24614009548070633904,
    0.25037859288473490738,
    0.25469007661067444293,
    0.25907580347259911990,
    0.26353705192673931856,
    0.26807512244416398239,
    0.27269133788986443800,
    0.27738704390838209157,
    0.28216360931606582207,
    0.28702242650008380487,
    0.29196491182431749678,
    0.29699250604222821037,
    0.30210667471685032082,
    0.30730890864800503026,
    0.31260072430687035894,
    0.31798366427804741763,
    0.32345929770921927338,
    0.32902922076857260558,
    0.33469505711008323834,
    0.34045845834681298658,
    0.34632110453237108239,
    0.35228470465064526396,
    0.35835099711398660238,
    0.36452175026995953244,
    0.37079876291681723721,
    0.37718386482786891989,
    0.38367891728485353786,
    0.39028581362052106041,
    0.39700647977054220883,
    0.40384287483492070647,
    0.41079699164909017073,
    0.41787085736481988096,
    0.42506653404114913553,
    0.43238611924547859511,
    0.43983174666502283801,
    0.44740558672878288915,
    0.45510984724023806347,
    0.46294677402093309393,
    0.47091865156513812440,
    0.47902780370579123304,
    0.48727659429189729146,
    0.49566742787761219891,
    0.50420275042316409220,
    0.51288505000787421029,
    0.52171685755543539820,
    0.53070074757168017587,
    0.53983933889507329518,
    0.54913529546009620663,
    0.55859132707380998450,
    0.56821019020576701841,
    0.57799468879152671175,
    0.58794767505002842878,
    0.59807205031500632053,
    0.60837076588075578165,
    0.61884682386243949903,
    0.62950327807120898260,
    0.64034323490441846793,
    0.65136985425113258508,
    0.66258635041326341408,
    0.67399599304254487198,
    0.68560210809363941742,
    0.69740807879368671429,
    0.70941734662850519655,
    0.72163341234581712680,
    0.73405983697572263491,
    0.74670024286874425723,
    0.75955831475177693068,
    0.77263780080217558943,
    0.78594251374038537339,
    0.79947633194135470092,
    0.81324320056508658805,
    0.82724713270669092413,
    0.84149221056619072368,
    0.85598258663852222483,
    0.87072248492399040298,
    0.88571620215958724032,
    0.90096810907149704750,
    0.91648265164918696346,
    0.93226435244143668335,
    0.94831781187466868133,
    0.96464770959399759320,
    0.98125880582734870128,
    0.99815594277311048277,
    1.01534404601162209225,
    1.03282812594102746395,
    1.05061327923781289151,
    1.06870469034249593321,
    1.08710763297093881974,
    1.10582747165162276204,
    1.12486966328945880988,
    1.14423975875648409328,
    1.16394340450994793201,
    1.18398634423830872997,
    1.20437442053550292087,
    1.22511357660411790427,
    1.24620985798784289500,
    1.26766941433375435189,
    1.28949850118499642626,
    1.31170348180425389018,
    1.33429082902870610461,
    1.35726712715686681499,
    1.38063907386791617782,
    1.40441348217413897181,
    1.42859728240689842771,
    1.45319752423689529941,
    1.47822137872915582157,
    1.50367614043340713792,
    1.52956922951050855453,
    1.55590819389540890860,
    1.58270071149743984940,
    1.60995459243844041275,
    1.63767778132941499436,
    1.66587835958646612866,
    1.69456454778650278392,
    1.72374470806361990149,
    1.75342734654666321248,
    1.78362111583881444155,
    1.81433481753983527618,
    1.84557740481178167435,
    1.87735798498890127384,
    1.90968582223243332763,
    1.94257034023116270660,
    1.97602112494842985235,
    2.01004792741653082189,
    2.04466066657911760274,
    2.07986943218266473465,
    2.11568448771764439087,
    2.15211627341034805738,
    2.18917540926631248865,
    2.22687269816602295691,
    2.26521912901405375607,
    2.30422587994235517073,
    2.34390432156868744329,
    2.38426602031126932957,
    2.42532274176035533841,
    2.46708645410801885589,
    2.50956933163689788202,
    2.55278375826901227086,
    2.59674233117579911223,
    2.64145786445015096078,
    2.68694339284184824379,
    2.73321217555720741288,
    2.78027770012415675893,
    2.82815368632398067561,
    2.87685409019059701308,
    2.92639310807887742527,
    2.97678518080290333003,
    3.02804499784548175612,
    3.08018750164027199645,
    3.13322789192746453679,
    3.18718163018464917258,
    3.24206444413385908021,
    3.29789233232622303049,
    3.35468156880569523537,
    3.41244870785289622361,
    3.47121058881084376679,
    3.53098434099364499872,
    3.59178738867971425464,
    3.65363745619111845997,
    3.71655257306016739705,
    3.78055107928519618099,
    3.84565163067668480679,
    3.91187320429553020418,
    3.97923510398488478046,
    4.04775696599733070258,
    4.11745876471895755344,
    4.18836081849192254367,
    4.26048379553736200620,
    4.33384871998018361694,
    4.40847697797780302409,
    4.48439032395415182464,
    4.56161088694130079091,
    4.64016117703009722817,
    4.72006409193189924167,
    4.80134292365346571074,
    4.88402136528651897862,
    4.96812351791451156657,
    5.05367389763811658554,
    5.14069744272171380572,
    5.22921952086312469277,
    5.31926593658823421151,
    5.41086293877325186230,
    5.50403722829630126512,
    5.59881596582075680146,
    5.69522677971284174703,
    5.79329777409522250764,
    5.89305753703962142964,
    5.99453514890029115492,
    6.09776019079097064690,
    6.20276275320806469438,
    6.30957344480194315395
])


## MAKE OTHER PLOT
j = 4 # Which mass index to use
# lumfac = basti_lum[j][0] / vpl_lum[j][0]
# tempfac = basti_temp[j][0] / vpl_temp[j][0]

fig, ax = plt.subplots(1, 2, figsize=(12, 6))
t = basti_time[j]
ax[0].plot(t/1.e6, basti_lum[j],  color='r')
ax[1].plot(t/1.e6, basti_temp[j], color='r')
j = 3
t = vpl_time[j]
ax[0].plot(t/1.e6, vpl_lum[j],  color='k')
ax[1].plot(t/1.e6, vpl_temp[j], color='k')
ax[0].plot(t/1.e6, )
ax[0].set_ylabel(r'Luminosity ($L_\odot$)')
ax[1].set_ylabel('Temperature (K)')
# ax[0].set_ylim(1.e-6, 1.e1)
# ax[1].set_ylim(3.e4, 5.e4)
for a in ax:
    # a.set_xlim(t[0]/1.e6, t[-1]/1.e6)
    a.set_xlim(0.0, t[-1]/1.e6)
    a.set_yscale('log')
    a.set_xlabel('Time (Myr)')
fig.tight_layout()
fig.savefig(path / 'single-wdtest.pdf')
